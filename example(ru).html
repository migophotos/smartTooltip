<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="favicon.png" />
    <title>SmartTooltip widget example</title>
    <meta name="Description" content="Author: M. Goyberg, SmartTooltip widget example">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">

    <script src="smarttooltip.js"></script>
    <style>
        .container {
          width: 80%;
          margin: 0 auto;
        }
        p {
            font-size: 18px;
            line-height: 2.0;
            padding-bottom: 27px;
        }
        text {
            font-size: 18pt;
            text-shadow: #4A4A4A 1px 1px 8px;
        }
        .label-red {
            cursor: pointer;
            background-color: red;
        }
        .label-green {
            cursor: pointer;
            background-color: rgb(19, 233, 19);
        }
        .label-blue {
            cursor: pointer;
            background-color: rgb(19, 147, 233);
        }
    </style>


</head>

<body>
    <smart-ui-tooltip is-shadow="0" start-from="float">Sorry, yout browser does not support custom elements.</smart-ui-tooltip>
    <div class="container">
        <h2>Как эффективно использовать SmartTooltip:<br> (настоятельно рекомендую прочитать этот абзац, и потренироваться в управлении этим умным виджетом)!</h2>

        <p>Наведи курсор на слово <b><label id="l1" class="sttip-link">accumsan</label></b>. Ты увидишь всплывающее окно содержащее заголовок - name, значение - value, текст -  descr, цветной индикатор - color
        Если тупо сидеть и смотреть на подсказку, то она погаснет через несколько секунд.  Увы, ничто не вечно под луной... :)</p>

        <p>Окно подсказки "<b><label id="l2" class="sttip-link">ползает</label></b>" за указателем мыши, но его можно зафиксировать. Для этого передвинь указатель мыши в область окна подсказки.
        В левом, верхнем углу окна подсказки расположен голубой кружок. Это кнопка "pinMe". Если ее нажать то подсказка будет "приколота" к любому последующему элементу
        на который ты наведешь <label id="l5" class="label-red">указатель</label> мыши.</p>

        <p>Попробуй нажми на кнопку "pinMe" и передвинь указатель мыши на слово "указатель" написанное черным по красному...
        Посмотри, как изменилось поведение окна подсказки - теперь оно не ползает, а прыгает! И помнит свое состояние даже после перезагрузки страницы.</p>

        <p>In quis <label id="l6" class="label-green">enim</label> <b><label id="l7" class="sttip-link">accumsan</label></b>, <label id="l8" class="label-green">sollicitudin</label> sem id, gravida ipsum. Fusce <label id="l9" class="label-green">suscipit</label> <b><label id="l10" class="sttip-link">accumsan</label></b> massa.
        Morbi vitae elementum lacus. Cras imperdiet urna vitae luctus laoreet. Vivamus venenatis
        porttitor tincidunt. Donec volutpat <label id="l12" class="label-green">rutrum</label> faucibus. Nullam et <b><label id="l14" class="sttip-link">accumsan</label></b> ante, vitae egestas
        arcu. Vivamus blandit arcu eget augue bibendum, sed imperdiet orci auctor. Mauris aliquet
        hendrerit suscipit. Aenean <label id="l15" class="label-green">ut</label> pulvinar diam, nec sagittis diam. Duis at gravida lacus,
        nec convallis erat. Etiam sit amet <label id="l16" class="label-green">quam</label>. Nulla facilisi.</p>

        <p>Теперь наведи указатель <label id="m1" class="label-blue">мыши</label>  на слово <b><label id="l2" class="sttip-link">Integer</label></b>, расположенное недалеко от <label id="m2" class="label-blue">слова</label> "accumsan".
        Вполне <label id="m3" class="label-blue">возможно</label> , что всплывшее окно подсказки закроет его. Это происходит потому, <label id="m4" class="label-blue">что</label>
        окно пытается уместиться на экране и... <label id="m5" class="label-blue">ну</label> вообщем - я это починю когда <label id="m6" class="label-blue">нибудь</label>. Что можно сделать сейчас? Тут есть один секрет:<br>
        Окно подсказки можно передвинуть с помощью мышки в любое место экрана! Просто кликни мышкой где нибудь в свободном сером поле и тяни. Просто dtag & drop!
        Как только ты перестанешь передвигать окошко, оно запомнит свои координаты и больше никуда не будет ползать и прыгать. Просто будет постоянно висеть
        на экране и отображать подсказки при наведении курсора на "горячие" пирожки. Ты можешь в любой момент передвинуть окошко куда-нибудь еще, ему все равно
        Оно будет запоминать новые координаты до тех пор пока ты снова не нажмешь на кнопку "<label id="m0" class="label-blue">pinMe</label>". :)</p>
    </div>
    <svg width="1200" height="200">
        <defs>
            <path id="myTextPath2" d="M65,20 l200,0 M75,40 l200,0 M75,60 l200,0 M75,80 l200,0 M75,100 l200,0"></path>
            <path id="strightLine" d="M10,40 l1000,0"></path>
        </defs>

        <text>
            <textPath xlink:href="#myTextPath2" >Окно подсказки можно передвинуть с помощью мышки в любое место экрана! Просто кликни мышкой где нибудь в свободном сером поле и тяни. Просто dtag & drop! Как только ты перестанешь передвигать окошко, оно запомнит свои координаты и больше никуда не будет ползать и прыгать.</textPath>
        </text>

        <rect x="1" y="1" width="1100" height="199" stroke="blue" fill="none"></rect>

    </svg>

    <script>
        var val2color = function(val) {
            var color;
            if (val < 25)
                color = "green";
            else if (val < 50)
                color = "blue";
            else if (val < 75)
                color = "yellow";
            else
                color = "red";
            return color;
        }
        var smallVal2color = function(val) {
            var color;
            if (val < 5)
                color = "green";
            else if (val < 7)
                color = "blue";
            else if (val < 8)
                color = "yellow";
            else
                color = "red";
            return color;
        }
        var item;
        var els = document.getElementsByClassName('sttip-link');
        for (item of els) {
            item.addEventListener('mouseover', function(evt) {
                var val = Math.floor(Math.random() * (100 - 0 + 1)) + 0;

                var cr = val2color(val);
                let valueMax = null;
                if (evt.target.id === 'l1')
                    val = val * 100;
                if (evt.target.id === 'l2') {
                    val = val * 150;
                    valueMax = 15000;
                }

                SmartTooltip.showTooltip({
                    id: evt.target.id,
                    x: evt.clientX,
                    y: evt.clientY,
                    options: {
                        position: evt.target.getBoundingClientRect()
                        , cssVars: {
                            // "--sttip-var-frame-fill": "#000",
                            // "--sttip-var-font-color": "#fff",
                            // "--sttip-var-legend-fill":"#000",
                            "--sttip-var-border-radius": "10"
                        }
                        , frameScale: 0.9
                    },
                    title: {
                        uuid: `uuid-${evt.target.id}`,
                        name: `${evt.target.textContent}`,
                        value: val,
                        valueMax: valueMax,
                        color: cr,
                        link: `https://www.google.com/search?q=${evt.target.textContent}`,

                        titleFormat: 'Word is $NAME$, random value is $VALUE$',
                        descrFormat: 'Click on the indicator, and let Google will help us!'
                    }
                }, evt);
            });
            item.addEventListener('mousemove', function(evt) {
                SmartTooltip.moveTooltip(evt);
            });
            item.addEventListener('mouseout', function(evt) {
                SmartTooltip.hideTooltip(evt);
            });
        }

        els = document.getElementsByClassName('label-red');
        for (item of els) {
            item.addEventListener('mouseover', function(evt) {
                var greenEls = document.getElementsByClassName('label-green');
                var data = {
                    id: evt.target.id,
                    x: evt.clientX,
                    y: evt.clientY,
                    options: {
                        position: evt.target.getBoundingClientRect()
                        , frameScale: 0.5
                        , showMode: 'pinned'
                        , isRun: 1
                        , cssVars: {
                            "--sttip-mouse-noactive": 5000
                        } },
                    title: {
                        uuid: `uuid-${evt.target.id}`,
                        name: `Number of words on a green background - ${greenEls.length}`,
                        descr: 'The pie shows the number of letters in each word',
                        color: 'red',
                        link: `https://www.google.com/search?q=${evt.target.textContent}`,
                        value: greenEls.length,
                        descrFormat: '$DESCR$'
                    },
                    targets: []
                };
                for (var subItem of greenEls) {
                    //subItem.setAttribute('id', subItem.textContent);
                    var subTarget = {
                        uuid: `uuid-${subItem.id}`,
                        name: subItem.textContent,
                        color: smallVal2color(subItem.textContent.length),
                        value: subItem.textContent.length,
                        link: `https://www.google.com/search?q=${subItem.textContent}`
                    }
                    data.targets.push(subTarget);
                }
                SmartTooltip.showTooltip(data, evt);
            });
            item.addEventListener('mousemove', function(evt) {
                SmartTooltip.moveTooltip(evt);
            });
            item.addEventListener('mouseout', function(evt) {
                SmartTooltip.hideTooltip(evt);
            });
        }
        els = document.getElementsByClassName('label-blue');
        for (item of els) {
            item.addEventListener('mouseover', function(evt) {
                var data = {
                    id: evt.target.id,
                    x: evt.clientX,
                    y: evt.clientY,
                    options: {
                        position: evt.target.getBoundingClientRect()
                        , frameScale: 0.6
                        , showMode: 'float'
                        , cssVars: {
                            "--sttip-var-frame-fill": "rgb(200, 255, 255)"
                            // "--sttip-var-legend-fill":"#000",
                            , "--sttip-var-font-color": "rgb(19, 147, 233)"
                            , "--sttip-var-border-color": "rgb(19, 147, 233)"
                        }
                    },
                    title: {
                        uuid: `uuid-${evt.target.id}`,
                        name: `"${evt.target.textContent}" on a blue background`,

                    }
                };
                SmartTooltip.showTooltip(data, evt);
            });
            item.addEventListener('mousemove', function(evt) {
                SmartTooltip.moveTooltip(evt);
            });
            item.addEventListener('mouseout', function(evt) {
                SmartTooltip.hideTooltip(evt);
            });
        }
    </script>
</body>

</html>

